<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MakeYourTrip - –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π –ø–æ –†–æ—Å—Å–∏–∏</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- –ò–∫–æ–Ω–∫–∏ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen flex flex-col">
    <!-- Header -->
    <header class="flex justify-between items-center p-6 md:p-8">
        <h1 class="text-2xl md:text-3xl font-bold text-white">MakeYourTrip</h1>
        <button id="authButton" class="bg-white/20 backdrop-blur-sm border border-white/30 text-white px-6 py-3 rounded-full font-semibold hover:bg-white/30 transition-all hover:-translate-y-1 hover:shadow-lg">
            –í–æ–π—Ç–∏ / –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
        </button>
    </header>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col items-center justify-center px-4 text-center">
        <h2 class="text-4xl md:text-5xl font-bold text-white mb-6">–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –ø–æ –†–æ—Å—Å–∏–∏</h2>
        
        <p class="text-xl text-white/90 max-w-2xl mb-12">
            –î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è:<br>
            ‚Ä¢ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä ‚Äî –∑–Ω–∞–µ—Ç–µ –∫—É–¥–∞ –µ–¥–µ—Ç–µ, –Ω—É–∂–µ–Ω –ø–ª–∞–Ω<br>
            ‚Ä¢ –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä ‚Äî –ø–æ–º–æ–∂–µ–º –≤—ã–±—Ä–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        </p>

        <h3 class="text-2xl font-semibold text-white mb-10">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:</h3>

        <div class="flex flex-col md:flex-row gap-8 max-w-4xl">
            <!-- Card 1 -->
            <div onclick="selectMode('definite')" class="card-hover bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-8 cursor-pointer w-full md:w-1/2">
                <div class="text-3xl mb-4">üìç</div>
                <h4 class="text-2xl font-bold text-white mb-4">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä</h4>
                <p class="text-white/80">–ó–Ω–∞—é –∫—É–¥–∞ –µ–¥—É, –Ω—É–∂–µ–Ω –ø–ª–∞–Ω –ø–æ–µ–∑–¥–∫–∏</p>
            </div>

            <!-- Card 2 -->
            <div onclick="selectMode('indefinite')" class="card-hover bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-8 cursor-pointer w-full md:w-1/2">
                <div class="text-3xl mb-4">ü§î</div>
                <h4 class="text-2xl font-bold text-white mb-4">–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä</h4>
                <p class="text-white/80">–ü–æ–º–æ–≥–∏—Ç–µ –≤—ã–±—Ä–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="text-center py-6 text-white/70">
        ¬© 2023 MakeYourTrip. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
    </footer>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const API_URL = 'http://127.0.0.1:8000/api';
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function checkAuth() {
            const token = localStorage.getItem('access_token');
            const button = document.getElementById('authButton');
            
            if (token) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞
                fetch(`${API_URL}/users/me`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                })
                .then(res => res.ok ? res.json() : Promise.reject())
                .then(user => {
                    button.innerHTML = `<i class="fas fa-user mr-2"></i>${user.username}`;
                    button.onclick = () => showProfile(user);
                })
                .catch(() => {
                    localStorage.removeItem('access_token');
                    setGuestButton();
                });
            } else {
                setGuestButton();
            }
        }
        
        function setGuestButton() {
            const button = document.getElementById('authButton');
            button.innerHTML = '–í–æ–π—Ç–∏ / –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è';
            button.onclick = () => window.location.href = 'auth.html';
        }
        
        function showProfile(user) {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è
            console.log('–ü–µ—Ä–µ—Ö–æ–¥ –≤ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', user.username);
            // window.location.href = 'profile.html';
        }
        
        function selectMode(mode) {
            const token = localStorage.getItem('access_token');
            const modes = {
                'definite': '–û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä',
                'indefinite': '–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä'
            };
            
            console.log(`–í—ã–±—Ä–∞–Ω —Ä–µ–∂–∏–º: ${modes[mode]}`);
            
            // –ï—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            if (token) {
                fetch(`${API_URL}/mode/${mode}`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                }).catch(console.error);
            }
            
            // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–∂–∏–º–∞
            // window.location.href = `mode_${mode}.html`;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', checkAuth);
        
        // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        window.debugAuth = () => {
            if (localStorage.getItem('access_token')) {
                localStorage.removeItem('access_token');
                console.log('–í—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω');
            } else {
                localStorage.setItem('access_token', 'demo_token');
                console.log('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω (–¥–µ–º–æ)');
            }
            checkAuth();
        };
    </script>
</body>
</html>