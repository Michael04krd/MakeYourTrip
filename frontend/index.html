<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MakeYourTrip - Планирование путешествий по России</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Иконки -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Наши стили -->
    <link rel="stylesheet" href="css/main.css">
    <style>
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="gradient-bg min-h-screen flex flex-col">
    <!-- Header -->
    <header class="flex justify-between items-center p-6 md:p-8">
        <h1 class="text-2xl md:text-3xl font-bold text-white">MakeYourTrip</h1>
        <div id="authContainer">
            <a href="auth.html" class="bg-white/20 backdrop-blur-sm border border-white/30 text-white px-6 py-3 rounded-full font-semibold hover:bg-white/30 transition-all hover:-translate-y-1 hover:shadow-lg">
                Войти / Зарегистрироваться
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col items-center justify-center px-4 text-center">
        <h2 class="text-4xl md:text-5xl font-bold text-white mb-6">Планируйте путешествия по России</h2>
        
        <p class="text-xl text-white/90 max-w-2xl mb-12">
            Два режима работы для идеального путешествия:<br>
            • Определенный выбор — знаете куда едете, нужен план<br>
            • Неопределенный выбор — поможем выбрать направление
        </p>

        <h3 class="text-2xl font-semibold text-white mb-10">Выберите режим работы:</h3>

        <div class="flex flex-col md:flex-row gap-8 max-w-4xl">
            <!-- Card 1 -->
            <a href="definite.html" class="card-hover bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-8 cursor-pointer w-full md:w-1/2 block hover:no-underline">
                <h4 class="text-2xl font-bold text-white mb-4">Определенный выбор</h4>
                <p class="text-white/80">Знаю куда еду, нужен план поездки</p>
            </a>

            <!-- Card 2 -->
            <div onclick="selectMode('indefinite')" class="card-hover bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-8 cursor-pointer w-full md:w-1/2">
                <h4 class="text-2xl font-bold text-white mb-4">Неопределенный выбор</h4>
                <p class="text-white/80">Помогите выбрать направление</p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="text-center py-6 text-white/70">
        © 2025 MakeYourTrip. Все права защищены.
    </footer>

    <!-- Скрипты -->
    <script src="js/api.js"></script>
    <script src="js/utils.js"></script>
    <script>
        // Проверка авторизации
        function checkAuth() {
            const token = localStorage.getItem('access_token');
            const container = document.getElementById('authContainer');
            
            if (token && window.api) {
                // Пробуем получить данные пользователя
                window.api.getCurrentUser()
                    .then(user => {
                        container.innerHTML = `
                            <div class="flex items-center space-x-4">
                                <span class="text-white/80">Привет, ${user.username}!</span>
                                <a href="profile.html" class="bg-white/20 backdrop-blur-sm border border-white/30 text-white px-6 py-3 rounded-full font-semibold hover:bg-white/30 transition-all hover:-translate-y-1 hover:shadow-lg">
                                    <i class="fas fa-user mr-2"></i>Профиль
                                </a>
                            </div>
                        `;
                    })
                    .catch(() => {
                        // Если ошибка - показываем кнопку входа
                        container.innerHTML = `
                            <a href="auth.html" class="bg-white/20 backdrop-blur-sm border border-white/30 text-white px-6 py-3 rounded-full font-semibold hover:bg-white/30 transition-all hover:-translate-y-1 hover:shadow-lg">
                                Войти / Зарегистрироваться
                            </a>
                        `;
                    });
            }
        }

        // Выбор режима
        function selectMode(mode) {
            if (mode === 'indefinite') {
                if (window.UIUtils) {
                    window.UIUtils.showNotification('Режим "Неопределенный выбор" в разработке. Пожалуйста, используйте "Определенный выбор".', 'info', 5000);
                } else {
                    alert('Режим "Неопределенный выбор" в разработке.');
                }
            }
            
            // Отправляем на сервер если авторизован
            const token = localStorage.getItem('access_token');
            if (token) {
                fetch(`http://127.0.0.1:8000/api/mode/${mode}`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                }).catch(() => {});
            }
        }

        // При загрузке страницы
        document.addEventListener('DOMContentLoaded', checkAuth);
    </script>
</body>
</html>